# Trade King - 실시간 멀티플레이어 무역 게임

"나는 무역왕이 될거야!"

## 📖 소개

**Trade King**은 교육용으로 설계된 실시간 멀티플레이어 무역 시뮬레이션 게임입니다. 플레이어는 스페인, 네덜란드, 영국, 프랑스 4개 국가 중 하나를 선택하여 팀을 이루고, 생산, 무역, 투자 활동을 통해 부를 축적하며 경쟁합니다.

이 프로젝트는 **Node.js** 백엔드와 순수 **JavaScript** 프론트엔드로 구성되어 있으며, **Socket.IO**를 통해 실시간 통신을 구현했습니다.

## ✨ 주요 기능

*   **실시간 멀티플레이:** 여러 명의 사용자가 같은 게임 룸에 접속하여 동시에 플레이할 수 있습니다.
*   **팀 기반 플레이:** 플레이어는 국가를 선택하고, 같은 국가를 선택한 다른 플레이어와 자동으로 한 팀이 됩니다.
*   **고유한 국가 특성:** 각 국가는 고유한 장단점을 가지고 있어, 다양한 전략적 플레이를 유도합니다.
*   **다양한 게임 단계:** 생산, 무역, 투자, 입항 등 각기 다른 단계로 게임이 진행됩니다.
*   **관리자 및 슈퍼 관리자 패널:**
    *   **교수자용 관리자 패널 (`/admin`):** 게임의 흐름(단계 시작, 타이머 관리 등)을 제어합니다.
    *   **서버 관리자용 패널 (`/super-admin`):** 전체 게임 서버의 방 목록을 모니터링하고 관리합니다.

## 🛠️ 기술 스택

*   **백엔드:** Node.js, Express.js, Socket.IO
*   **프론트엔드:** HTML, CSS, Vanilla JavaScript
*   **인증:** 관리자 패널을 위한 기본 인증(Basic Authentication)

## 🚀 시작하기

### 사전 요구 사항

*   Node.js (v14 이상)
*   npm

### 설치 방법

1.  저장소를 복제(clone)합니다:
    ```bash
    git clone <repository-url>
    ```
2.  프로젝트 디렉토리로 이동합니다:
    ```bash
    cd trade-king
    ```
3.  필요한 패키지를 설치합니다:
    ```bash
    npm install
    ```

### 애플리케이션 실행

서버를 시작하려면 아래 명령어를 실행하세요:

```bash
npm start
```

기본적으로 서버는 3000번 포트에서 실행됩니다.

*   **학생 접속 주소:** `http://localhost:3000`
*   **교수자 접속 주소:** `http://localhost:3000/admin`
*   **서버 관리자 접속 주소:** `http://localhost:3000/super-admin`

### 설정

*   **서버 관리자 비밀번호:** `server.js` 파일에 하드코딩되어 있습니다. 기본 사용자는 `superadmin`, 비밀번호는 `superadmin`입니다. 실제 운영 환경에서는 이 값을 변경하는 것을 강력히 권장합니다.

## 🎮 게임 방법

1.  **방 생성:** 교수자가 관리자 패널에서 새로운 게임 방을 생성합니다.
2.  **방 코드 공유:** 생성된 4자리 방 코드를 학생들에게 공유합니다.
3.  **팀 참가:** 학생들은 자신의 이름과 방 코드를 입력한 후, 국가를 선택하여 팀에 참가합니다.
4.  **게임 진행:** 교수자는 아래 순서대로 게임 단계를 진행시킵니다.
    *   **생산:** 플레이어들이 클릭을 통해 재화(PA)를 생산합니다.
    *   **무역:** 팀별로 항해할 목적지(중국-비단, 인도-후추)와 투자할 금액을 결정합니다.
    *   **투자:** 다른 팀의 항해에 투자할 수 있습니다.
    *   **입항:** 무작위 이벤트와 가위바위보를 통해 항해 결과가 결정됩니다.
5.  **게임 종료:** 교수자가 게임을 종료하면, 팀별 총자산을 기준으로 최종 순위가 표시됩니다.

## 📜 상세 게임 규칙

### 국가별 특성

| 국가      | 아이콘 | 최대 클릭 수 | 클릭당 PA | 특수 능력                                |
| :---------- | :--: | :--------- | :----------- | :--------------------------------------------- |
| **스페인**   |  🇪🇸  | 1000회     | 1 PA         | 자원이 풍부한 국가                           |
| **네덜란드** |  🇳🇱  | 600회      | 1.5 PA       | 기술이 발전한 국가                           |
| **영국**    |  🇬🇧  | 600회      | 1 PA         | 가위바위보 재도전 토큰 2개 보유                |
| **프랑스**  |  🇫🇷  | 600회      | 1 PA         | 중상주의: 성공적인 무역/투자 시 +50 PA 보너스 |

### 게임 단계별 규칙

1.  **생산 단계**
    *   플레이어는 클릭하여 재화(PA)를 생산합니다.
    *   가위바위보를 통해 추가 PA를 획득할 수 있습니다:
        *   **승리:** +50 PA
        *   **무승부:** 0 PA
        *   **패배:** -50 PA

2.  **무역 단계**
    *   팀은 항해할 목적지를 선택합니다:
        *   **중국:** 비단 획득 기회
        *   **인도:** 후추 획득 기회
        *   **출항 안함:** 해당 라운드 휴식
    *   항해에는 최소 200 PA가 필요하며, 100 PA 단위로만 투자할 수 있습니다.

3.  **투자 단계**
    *   다른 팀의 항해에 100 PA 단위로 투자할 수 있습니다.
    *   항해가 성공하면 투자자는 투자금에 비례하여 무역품을 분배받습니다.
        *   **순풍:** 100 PA당 무역품 1개
        *   **무역풍:** 100 PA당 무역품 2개
    *   투자 원금은 입항 시 즉시 반환됩니다.

4.  **입항 단계**
    *   항해 결과는 아래 두 가지 요소에 의해 결정됩니다:
        1.  **이벤트 카드 (무작위 추첨):**
            *   **무역풍 (15%):** 획득 무역품 2배
            *   **카무사리 (20%):** 무역품 모두 상실
            *   **순풍 (65%):** 기본 보상 (변동 없음)
        2.  **입항 가위바위보:**
            *   **승리:** 무역품 +1개
            *   **무승부:** 무역품 +0개
            *   **패배:** 무역품 -1개

### 승리 조건

*   최종 순위는 각 팀의 총자산으로 결정됩니다.
*   총자산 = 보유 PA + (비단 개수 × 비단 가치) + (후추 개수 × 후추 가치)
*   비단과 후추의 기본 가치는 각각 100 PA입니다.
*   **희소성 보너스:** 게임 종료 시, 전체 수량이 더 적은 무역품의 가치가 10% 증가합니다.
*   **독점 보너스:** 특정 무역품을 50% 이상 보유한 팀은 게임 종료 시 200 PA 보너스를 받습니다.

## 📂 프로젝트 구조

```
trade-king/
├── .git/               # Git 저장소 데이터
├── node_modules/       # Node.js 패키지
├── public/             # 프론트엔드 파일 (클라이언트)
│   ├── admin.html          # 교수자용 관리 패널 UI
│   ├── admin-client.js     # 교수자용 클라이언트 로직
│   ├── super-admin.html    # 서버 관리자용 패널 UI
│   ├── super-admin-client.js # 서버 관리자용 클라이언트 로직
│   ├── index.html        # 학생용 메인 게임 UI
│   ├── game.js           # 학생용 메인 게임 로직
│   ├── styles.css        # 모든 페이지에 적용되는 CSS 스타일
│   └── utils.js          # 클라이언트 측 보조 함수
├── game-logic/         # 핵심 백엔드 게임 로직
│   ├── handlers.js       # Socket.IO 이벤트 핸들러
│   ├── rooms.js          # 게임 방 및 팀 상태 관리
│   └── utils.js          # 백엔드 보조 함수
├── config.js           # 게임 설정 (국가 특성, 이벤트 등)
├── package.json        # 프로젝트 정보 및 의존성
├── package-lock.json   # 의존성 버전 고정
├── server.js           # 메인 서버 파일 (Express, Socket.IO 설정)
├── README.md           # 이 파일 (프로젝트 안내서)
└── RULEBOOK.md         # 상세 게임 규칙 (한글 원본)
```

## 🔌 API (Socket.IO 이벤트)

### 서버 → 클라이언트

*   `room_created`: 교수자에게 새로운 방 ID를 전송합니다.
*   `room_list_update`: 슈퍼 관리자에게 모든 방 목록을 전송합니다.
*   `error`: 오류 발생 시 해당 클라이언트에게 에러 메시지를 전송합니다.
*   `game_state_update`: 게임 상태(단계, 라운드) 변경 시 모든 클라이언트에게 전송합니다.
*   `teams_update`: 팀 데이터 변경 시 모든 클라이언트에게 전송합니다.
*   `timer_update`: 남은 시간을 주기적으로 전송합니다.
*   `rps_result`: 생산 단계 가위바위보 결과를 해당 플레이어에게 전송합니다.
*   `final_rps_result`: 입항 단계 가위바위보 결과를 해당 플레이어에게 전송합니다.
*   `event_result`: 이벤트 카드 추첨 결과를 해당 플레이어에게 전송합니다.
*   `investment_info`: 투자 단계 시작 시 투자 가능한 항해 정보를 모든 클라이언트에게 전송합니다.
*   `game_ended`: 게임 종료 시 최종 순위를 모든 클라이언트에게 전송합니다.

### 클라이언트 → 서버

*   `create_room`: 교수자가 새 게임 방 생성을 요청합니다.
*   `get_room_list`: 슈퍼 관리자가 전체 방 목록을 요청합니다.
*   `force_close_room`: 슈퍼 관리자가 특정 방을 강제 종료합니다.
*   `check_room`: 학생이 입력한 방 코드의 유효성을 확인합니다.
*   `register_player`: 학생이 방과 팀에 참가를 요청합니다.
*   `start_phase`: 교수자가 다음 게임 단계를 시작합니다.
*   `production_batch`: 학생이 생산(클릭)한 횟수를 묶어서 전송합니다.
*   `trade_selection`: 팀이 무역 항해 정보를 제출합니다.
*   `make_investment`: 팀이 다른 팀에 투자를 합니다.
*   `play_rps`: 학생이 생산 단계 가위바위보를 합니다.
*   `reroll_rps`: 영국 팀 학생이 생산 단계 가위바위보를 재도전합니다.
*   `draw_event`: 학생이 이벤트 카드를 뽑습니다.
*   `play_final_rps`: 학생이 입항 단계 가위바위보를 합니다.
*   `reroll_final_rps`: 영국 팀 학생이 입항 단계 가위바위보를 재도전합니다.
*   `reset_game`: 교수자가 게임을 초기화합니다.
*   `end_game`: 교수자가 게임을 종료합니다.
*   `start_timer`: 교수자가 타이머를 시작합니다.
*   `stop_timer`: 교수자가 타이머를 중지합니다.

## 🙌 기여하는 방법

Trade King 개선을 위한 모든 기여를 환영합니다!

### 버그 리포트

버그를 발견했다면 GitHub 저장소에 이슈(Issue)를 등록해주세요. 아래 정보를 포함해주시면 좋습니다:
*   명확하고 설명적인 제목
*   버그를 재현할 수 있는 단계
*   예상했던 결과
*   실제로 발생한 현상 (스크린샷이 있다면 큰 도움이 됩니다)

### 기능 제안

새로운 기능에 대한 아이디어가 있다면, 이슈를 등록하여 논의를 시작해주세요. 더 좋은 게임을 만들기 위한 아이디어는 언제나 환영입니다!

### Pull Request (PR)

1.  이 저장소를 Fork하세요.
2.  새로운 브랜치를 생성하세요 (`git checkout -b feature/YourFeatureName`).
3.  변경 사항을 만드세요.
4.  변경 사항을 커밋하세요 (`git commit -m 'Add some feature').
5.  브랜치에 Push하세요 (`git push origin feature/YourFeatureName`).
6.  Pull Request를 생성해주세요.
